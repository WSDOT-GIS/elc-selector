(function(n,t){typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?module.exports=t():n.elc=t()})(this,function(){"use strict";function r(n){return n.getMonth()+1}function u(n){var r=[],t;for(var i in n)n.hasOwnProperty(i)&&(t=n[i],t==null&&(t=""),r.push([i,encodeURIComponent(t)].join("=")));return r.join("&")}function s(n,t){return(t||(t=2e3),typeof n=="string")?n.length>2e3:!1}function n(n,t,i,r){this.url=n||"http://www.wsdot.wa.gov/geoservices/arcgis/rest/services/Shared/ElcRestSOE/MapServer/exts/ElcRestSoe";this.findRouteLocationsOperationName=t||"Find Route Locations";this.findNearestRouteLocationsOperationName=i||"Find Nearest Route Locations";this.routesResourceName=r||"routes";this.layerList=null}function t(n,t){this.name=n;this.lrsTypes=t}function h(n){var i,u,r;for(i in n)if(n.hasOwnProperty(i)){u=[];for(r in n[i])n[i].hasOwnProperty(r)&&u.push(new t(r,n[i][r]));this[i]=u}}function f(n){var i,o,r,s,t,u,e;if(typeof n=="undefined"||n===null)return n;if(typeof n!="object"||!(n instanceof Array))throw new Error("array must be an Array object.");for(e=[],i=0,o=n.length;i<o;i+=1)if(t=n[i],u=null,typeof t=="object"&&t instanceof Array)for(u=f(t),r=0,s=u.length;r<s;r+=1)e.push(u[r]);else e.push(t);return e}function c(n){return typeof n=="object"&&n instanceof Date?[String(r(n)),String(n.getDate()),String(n.getFullYear())].join("/"):n||""}function l(n,t){var r,i,u;if(typeof n=="undefined"||n===null||typeof n.length!="number")throw new Error("The array parameter must actually be an Array.");for(r=[],i=0,u=n.length;i<u;i+=1)r.push(new t(n[i]));return r}function i(n){var t=typeof n=="object",i;this.Id=t&&typeof n.Id!="undefined"?n.Id:null;this.Route=t&&typeof n.Route!="undefined"?n.Route:null;this.Decrease=t&&typeof n.Decrease!="undefined"?n.Decrease:null;this.Arm=t&&typeof n.Arm!="undefined"?n.Arm:null;this.Srmp=t&&typeof n.Srmp!="undefined"?n.Srmp:null;this.Back=t&&typeof n.Back!="undefined"?n.Back:null;this.ReferenceDate=t&&typeof n.ReferenceDate!="undefined"?n.ReferenceDate:null;this.ResponseDate=t&&typeof n.ResponseDate!="undefined"?n.ResponseDate:null;this.RealignmentDate=t&&typeof n.RealignmentDate!="undefined"?n.RealignmentDate:null;this.EndArm=t&&typeof n.EndArm!="undefined"?n.EndArm:null;this.EndSrmp=t&&typeof n.EndSrmp!="undefined"?n.EndSrmp:null;this.EndBack=t&&typeof n.EndBack!="undefined"?n.EndBack:null;this.EndReferenceDate=t&&typeof n.EndReferenceDate!="undefined"?n.EndReferenceDate:null;this.EndResponseDate=t&&typeof n.EndResponseDate!="undefined"?n.EndResponseDate:null;this.EndRealignDate=t&&typeof n.EndRealignDate!="undefined"?n.EndRealignDate:null;this.ArmCalcReturnCode=t&&typeof n.ArmCalcReturnCode!="undefined"?n.ArmCalcReturnCode:null;this.ArmCalcEndReturnCode=t&&typeof n.ArmCalcEndReturnCode!="undefined"?n.ArmCalcEndReturnCode:null;this.ArmCalcReturnMessage=t&&typeof n.ArmCalcReturnMessage!="undefined"?n.ArmCalcReturnMessage:null;this.ArmCalcEndReturnMessage=t&&typeof n.ArmCalcEndReturnMessage!="undefined"?n.ArmCalcEndReturnMessage:null;this.LocatingError=t&&typeof n.LocatingError!="undefined"?n.LocatingError:null;this.RouteGeometry=t&&typeof n.RouteGeometry!="undefined"?n.RouteGeometry:null;this.EventPoint=t&&typeof n.EventPoint!="undefined"?n.EventPoint:null;this.Distance=t&&typeof n.Distance!="undefined"?n.Distance:null;this.Angle=t&&typeof n.Angle!="undefined"?n.Angle:null;for(i in this)this.hasOwnProperty(i)&&/Date$/gi.test(i)&&(typeof this[i]=="string"||typeof this[i]=="number")&&(this[i]=new Date(this[i]))}function a(n,t){var i;if((t===null||typeof t=="undefined")&&(t="this"),typeof n!==undefined&&n!==null){if(n=Number(n),isNaN(n))throw new Error(["If",t,"property is provided, it must be a number."].join(" "));i=n}else if(n===null)return null;return i}var e,o;e=/^(\d{3})(?:((?:AR)|(?:C[DI])|(?:C[O])|(?:F[DI])|(?:LX)|(?:[PQRS][\dU])|(?:RL)|(?:SP)|(?:TB)|(?:TR)|(?:PR)|(?:F[ST])|(?:ML))([A-Z0-9]{0,6}))?$/i;o=/^([\d\.]+)(B)?$/i;return t.prototype.isIncrease=function(){return this.lrsTypes===1||this.lrsTypes===3},t.prototype.isDecrease=function(){return this.lrsTypes===2||this.lrsTypes===3},t.prototype.isBoth=function(){return this.lrsTypes===3},t.prototype.isRamp=function(){return this.lrsTypes===4},h.prototype.getYearList=function(){var n,t=[];for(n in this)this.hasOwnProperty(n)&&t.push(n);return t.sort(),t},n.prototype.getMapServiceUrl=function(){return this.url.match(/.+\/MapServer/gi)[0]},n.prototype.getRouteList=function(n,t,i){var r=this,f,e,o;if(i==null&&(i=!0),r.layerList){typeof n=="function"&&n(r.layerList);return}try{e=new XMLHttpRequest;o=[r.url,r.routesResourceName].join("/");f={f:"json"};i||(f.callback="jsonp");f=u(f);o=[o,f].join("?");e.open("get",o);e.responseType="json";e.addEventListener("loadend",function(i){var u,f;f=i.target.response;this.status===200?(u=new h(f),r.layerList=u,n(u)):typeof t=="function"&&t(f)});e.send()}catch(s){typeof(t==="function")&&t(s)}},n.dateToRouteLocatorDate=c,i.prototype.isLine=function(){return this.EndArm!==null||this.EndSrmp!==null},n.prototype.findRouteLocations=function(n){var o,t,e,h,y,f,w,p,c;if(o=n.locations,t=n.referenceDate||"",e=n.outSR||null,h=n.lrsYear||null,y=n.successHandler,f=n.errorHandler,w=n.useCors!=null?n.useCors:!0,typeof o=="object"&&o instanceof Array){if(!o.length)throw new Error("locations does not have enough elements.");}else throw new Error("The locations parameter must be an array of RouteLocations with at least one element.");if(typeof t=="object"&&t instanceof Date&&(t=[String(r(t)),String(t.getDate()),String(t.getFullYear())].join("/")),typeof e!="undefined"&&e!==null&&typeof e!="number"&&typeof e!="string")throw new Error("Unexpected outSR type.  Must be a WKID (number), WKT (string), or omitted (null or undefined).");if(typeof h!="undefined"&&h!==null&&typeof h!="string")throw new Error("Invalid lrsYear.  Must be either a string or omitted altogether.");if(typeof y!="function")throw new Error("No successHandler was specified.");try{p={f:"json",locations:JSON.stringify(o),outSR:e||null,referenceDate:t||null,lrsYear:h||null};c=[this.url,this.findRouteLocationsOperationName].join("/");w||(p.callback="jsonp");var a=new XMLHttpRequest,v=u(p),b=s([c,v].join("?"))?"POST":"GET";b==="GET"&&(c=[c,v].join("?"),v=null);a.open(b,c);v&&a.setRequestHeader("Content-Type","application/x-www-form-urlencoded");a.responseType="json";a.addEventListener("loadend",function(n){var t;t=n.target.response;n.target.status===200?t.error&&typeof f=="function"?f(t):y(l(t,i)):typeof f=="function"&&f(t)});a.send(v)}catch(k){typeof(f==="function")&&f(k)}},n.prototype.findNearestRouteLocations=function(n){var t={f:"json"},e;if(n.useCors==null&&(n.useCors=!0),typeof n.referenceDate=="undefined"||n.referenceDate===null)throw new Error("referenceDate not provided.");else t.referenceDate=c(n.referenceDate);if(n.coordinates=f(n.coordinates),typeof n.coordinates=="object"&&n.coordinates instanceof Array){if(n.coordinates.length<2||n.coordinates.length%2!=0)throw new Error("The coordinates array must contain at least two elements and consist of an even number of elements.");}else throw new Error("The coordinates parameter must be an array of numbers.");if(t.coordinates=JSON.stringify(n.coordinates),typeof n.searchRadius!="number"||n.searchRadius<=0)throw new Error("searchRadius must be a number that is greater than zero.");else t.searchRadius=n.searchRadius;if(typeof n.inSR!="number"&&typeof n.outSR!="string")throw new Error("Unexpected inSR type.  The inSR value must be either a WKID (number) or a WKT (string).");else t.inSR=n.inSR;if(typeof n.outSR!="undefined"&&n.outSR!==null&&typeof n.outSR!="number"&&typeof n.outSR!="string")throw new Error("Unexpected outSR type.  Must be a WKID (number), WKT (string), or omitted (null or undefined).");else t.outSR=n.outSR;if(typeof n.lrsYear!="undefined"&&n.lrsYear!==null&&typeof n.lrsYear!="string")throw new Error("Invalid lrsYear.  Must be either a string or omitted altogether.");else t.lrsYear=n.lrsYear||undefined;if(t.routeFilter=n.routeFilter||undefined,typeof n.routeFilter!="undefined"&&typeof n.routeFilter!="string")throw new Error("Invalid route filter type.  The routeFilter parameter should be either a string or omitted altogether.");if(typeof n.successHandler!="function")throw new Error("No successHandler was specified.");try{e=[this.url,this.findNearestRouteLocationsOperationName].join("/");n.useCors||(t.callback="jsonp");var h=u(t),o=s(e+"?"+h)?"POST":"GET",r=new XMLHttpRequest;o==="GET"&&(e=[e,h].join("?"));r.open(o,e);o==="POST"&&r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");r.responseType="json";r.addEventListener("loadend",function(t){var r;r=t.target.response;t.target.status===200?r.error&&typeof n.errorHandler=="function"?n.errorHandler(r):n.successHandler(l(r,i)):typeof n.errorHandler=="function"&&n.errorHandler(r)});o==="POST"?r.send(h):r.send()}catch(a){typeof n.errorHandler=="function"&&n.errorHandler(a)}},i.prototype.toJSON=function(){var t,n,u,i,f,s,h,c;i={};f=/(?:Id)|(?:(?:End)?Arm)|(ReturnCode)|(Distance)|(Angle)/gi;s=/Srmp$/gi;c=/(?:Decrease)|(Back)$/gi;h=/Date$/gi;for(t in this)if(this.hasOwnProperty(t))if(n=this[t],f.test(t))n!==null&&(i[t]=a(n,t));else if(s.test(t)){if(typeof n=="number")i[t]=n;else if(typeof n=="string")if(u=o.exec(n),u)i[t]=Number(u[1]),u[2]&&(/End$/.test(t)?i.EndBack=!0:t==="Srmp"&&(i.Back=!0));else throw new Error(["Invalid",t,"value:",String(n)].join(" "));}else if(t==="Route"){if(typeof n=="string")if(u=e.exec(this[t]),u)i.Route=u[0];else throw new Error("Route is invalidly formatted.");else if(n!==null)throw new Error("Route must be a string.");}else c.test(t)?i.Decrease=n===null?null:Boolean(n):h.test(t)&&Boolean(n)?n instanceof Date&&(i[t]=[String(r(n)),String(n.getDate()),String(n.getFullYear())].join("/")):n!==null&&(i[t]=n);return i},{ROUTE_TYPE_INCREASE:1,ROUTE_TYPE_DECREASE:2,ROUTE_TYPE_BOTH:3,ROUTE_TYPE_RAMP:4,RouteLocator:n,RouteLocation:i,flattenArray:f}});
/*
//# sourceMappingURL=elc.min.js.map
*/